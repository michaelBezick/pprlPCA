/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
wandb: Currently logged in as: michael-bezick (michael-bezick-purdue-university) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: WARNING Using a boolean value for 'reinit' is deprecated. Use 'return_previous' or 'finish_previous' instead.
wandb: Tracking run with wandb version 0.20.1
wandb: Run data is saved locally in /home/exx/Michael/pprlPCA/wandb/run-20250908_141022-4bqu6m3s
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fearless-sun-975
wandb: â­ï¸ View project at https://wandb.ai/michael-bezick-purdue-university/pprl
wandb: ðŸš€ View run at https://wandb.ai/michael-bezick-purdue-university/pprl/runs/4bqu6m3s
Group name is:  PC_PCA
Instantiating 8 environments...
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Environments instantiated.
Instantiating 1 environments...
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Environments instantiated.
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/mani_skill2/utils/visualization/misc.py:56: RuntimeWarning: invalid value encountered in divide
  depth = (depth - min_depth) / (max_depth - min_depth)
Instantiating 1 environments...
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Environments instantiated.
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/mani_skill2/utils/visualization/misc.py:56: RuntimeWarning: invalid value encountered in divide
  depth = (depth - min_depth) / (max_depth - min_depth)
Instantiating 1 environments...
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Environments instantiated.
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/mani_skill2/utils/visualization/misc.py:56: RuntimeWarning: invalid value encountered in divide
  depth = (depth - min_depth) / (max_depth - min_depth)
Instantiating 1 environments...
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Environments instantiated.
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/mani_skill2/utils/visualization/misc.py:56: RuntimeWarning: invalid value encountered in divide
  depth = (depth - min_depth) / (max_depth - min_depth)
Instantiating 1 environments...
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Environments instantiated.
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/mani_skill2/utils/visualization/misc.py:56: RuntimeWarning: invalid value encountered in divide
  depth = (depth - min_depth) / (max_depth - min_depth)
Instantiating 1 environments...
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Environments instantiated.
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/mani_skill2/utils/visualization/misc.py:56: RuntimeWarning: invalid value encountered in divide
  depth = (depth - min_depth) / (max_depth - min_depth)
Instantiating 1 environments...
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Environments instantiated.
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/mani_skill2/utils/visualization/misc.py:56: RuntimeWarning: invalid value encountered in divide
  depth = (depth - min_depth) / (max_depth - min_depth)
Instantiating 1 environments...
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Environments instantiated.
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/mani_skill2/utils/visualization/misc.py:56: RuntimeWarning: invalid value encountered in divide
  depth = (depth - min_depth) / (max_depth - min_depth)
Instantiating 1 environments...
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/sapien/core/renderer_config.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Environments instantiated.
/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/mani_skill2/utils/visualization/misc.py:56: RuntimeWarning: invalid value encountered in divide
  depth = (depth - min_depth) / (max_depth - min_depth)
BasicSampler: Resetting all environments.
BasicSampler: Resetting agent.
SAC: Given sampler batch size 2560, training batch size 512, and replay ratio 16, there will be 80 updates per iteration.
SAC: Using learnable entropy coefficient with target entropy of -20
RLRunner: Starting training...
RLRunner: Saving log files to /home/exx/Michael/pprlPCA/wandb/run-20250908_141022-4bqu6m3s/files
  0%|          | 0/1000000 [00:00<?, ?steps/s]RLRunner: Evaluating agent...
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
Saved video of policy to videos/2025-09-08/4bqu6m3s/nominal/policy_step_0.mp4.
wandb: WARNING `fps` argument does not affect the frame rate of the video when providing a file path or raw bytes.
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
wandb: WARNING Step cannot be set when using tensorboard syncing. Please use `run.define_metric(...)` to define a custom metric to log your step values.
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
EvalSampler: Resetting all environments.
EvalSampler: Resetting agent.
RLRunner: Finished evaluating agent.
                                                0%|          | 0/1000000 [05:33<?, ?steps/s]----------------------------------
| eval/               |          |
|    Length           | 200      |
|    Return           | -215     |
|    NonzeroRewards   | 200      |
|    DiscountedReturn | -215     |
|    Success          | 0        |
|    SuccessLength    | 200      |
| time/               |          |
|    iterations       | 0        |
|    fps              | 0        |
|    elapsed_time     | 334      |
|    elapsed_steps    | 0        |
----------------------------------
For the first 10000 steps, agent will use a fixed std of 0.75 for exploration.
  0%|          | 2560/1000000 [06:26<41:49:47,  6.62steps/s]  1%|          | 5120/1000000 [07:25<20:56:38, 13.20steps/s]  1%|          | 5120/1000000 [07:40<20:56:38, 13.20steps/s]  1%|          | 7680/1000000 [08:20<14:02:51, 19.62steps/s]                                                              1%|          | 7680/1000000 [08:20<14:02:51, 19.62steps/s]----------------------------------
| rollout/            |          |
|    Length           | 200      |
|    Return           | -205     |
|    NonzeroRewards   | 200      |
|    DiscountedReturn | -205     |
|    Success          | 0        |
|    SuccessLength    | 200      |
| time/               |          |
|    iterations       | 3        |
|    fps              | 46.1     |
|    elapsed_time     | 501      |
|    elapsed_steps    | 7680     |
----------------------------------
  1%|          | 7680/1000000 [08:40<14:02:51, 19.62steps/s][31mERROR: POS SHAPE: torch.Size([159128, 3])
 BATCH SHAPE: torch.Size([159128])
 CENTER POINTS SHAPE: torch.Size([10192, 3])
 EDGES SHAPE: torch.Size([2, 326144])
[0m
[31mERROR: OutOfMemoryError: CUDA out of memory. Tried to allocate 638.00 MiB. GPU 0 has a total capacty of 23.69 GiB of which 614.00 MiB is free. Process 1911303 has 167.52 MiB memory in use. Process 1911931 has 167.52 MiB memory in use. Process 1913507 has 167.52 MiB memory in use. Process 1914370 has 167.52 MiB memory in use. Process 1916021 has 167.52 MiB memory in use. Process 1916629 has 167.52 MiB memory in use. Process 1918460 has 167.52 MiB memory in use. Process 1919331 has 167.52 MiB memory in use. Process 1920936 has 167.52 MiB memory in use. Process 1921946 has 167.52 MiB memory in use. Process 1924554 has 9.03 GiB memory in use. Including non-PyTorch memory, this process has 5.42 GiB memory in use. Process 1925477 has 167.52 MiB memory in use. Process 1925590 has 167.52 MiB memory in use. Process 1928031 has 167.52 MiB memory in use. Process 1928034 has 167.52 MiB memory in use. Process 1930230 has 295.52 MiB memory in use. Process 1930109 has 295.52 MiB memory in use. Process 1932624 has 295.52 MiB memory in use. Process 1933055 has 295.52 MiB memory in use. Process 1935242 has 167.52 MiB memory in use. Process 1935632 has 167.52 MiB memory in use. Process 1937385 has 167.52 MiB memory in use. Process 1938101 has 167.52 MiB memory in use. Process 1939814 has 167.52 MiB memory in use. Process 1940602 has 167.52 MiB memory in use. Process 1942270 has 295.52 MiB memory in use. Process 1943047 has 295.52 MiB memory in use. Process 1945277 has 167.52 MiB memory in use. Process 1945551 has 167.52 MiB memory in use. Process 1947493 has 167.52 MiB memory in use. Process 1947907 has 167.52 MiB memory in use. Process 1950041 has 167.52 MiB memory in use. Process 1950465 has 167.52 MiB memory in use. Process 1952653 has 167.52 MiB memory in use. Process 1952963 has 255.52 MiB memory in use. Process 1955208 has 295.52 MiB memory in use. Process 1955525 has 167.52 MiB memory in use. Process 1957698 has 167.52 MiB memory in use. Process 1958027 has 167.52 MiB memory in use. Process 1960010 has 167.52 MiB memory in use. Process 1960302 has 167.52 MiB memory in use. Process 1962186 has 167.52 MiB memory in use. Process 1962850 has 167.52 MiB memory in use. Process 1964510 has 167.52 MiB memory in use. Process 1964892 has 167.52 MiB memory in use. Process 2005536 has 167.52 MiB memory in use. Of the allocated memory 2.51 GiB is allocated by PyTorch, and 2.58 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF[0m
Error executing job with overrides: ['wandb.group_name=PC_PCA', 'env=push_chair', 'model=ppt']
Traceback (most recent call last):
  File "/home/exx/Michael/pprlPCA/scripts/maniskill_train_sac.py", line 718, in main
    runner.run()
  File "/home/exx/Michael/pprlPCA/dependencies/parllel/parllel/runners/rlrunner.py", line 95, in run
    algo_info = self.algorithm.optimize_agent(
  File "/home/exx/Michael/pprlPCA/dependencies/parllel/parllel/torch/algos/sac.py", line 115, in optimize_agent
    self.train_once(replay_samples)
  File "/home/exx/Michael/pprlPCA/dependencies/parllel/parllel/torch/algos/sac.py", line 135, in train_once
    q_loss = self.critic_loss(samples)
  File "/home/exx/Michael/pprlPCA/dependencies/parllel/parllel/torch/algos/sac.py", line 214, in critic_loss
    observation = self.agent.encode(samples["observation"])
  File "/home/exx/Michael/pprlPCA/dependencies/parllel/parllel/torch/agents/sac_agent.py", line 59, in encode
    observation = self.model["encoder"](observation)
  File "/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/exx/Michael/pprlPCA/pprl/models/ppt.py", line 150, in forward
    x, _, center_points = self.tokenizer(pos, batch, color)
  File "/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/exx/Michael/pprlPCA/pprl/models/modules/tokenizer.py", line 127, in forward
    raise e
  File "/home/exx/Michael/pprlPCA/pprl/models/modules/tokenizer.py", line 120, in forward
    x, neighborhoods = self.propagate(edges, pos=(pos, center_points), x=color)
  File "/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/torch_geometric/nn/conv/message_passing.py", line 463, in propagate
    out = self.message(**msg_kwargs)
  File "/home/exx/Michael/pprlPCA/pprl/models/modules/tokenizer.py", line 176, in message
    msg = self.mlp_2(msg.reshape(-1, msg.shape[-1]))
  File "/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/torch_geometric/nn/models/mlp.py", line 237, in forward
    x = self.act(x)
  File "/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 101, in forward
    return F.relu(input, inplace=self.inplace)
  File "/home/exx/anaconda3/envs/pprl/lib/python3.10/site-packages/torch/nn/functional.py", line 1471, in relu
    result = torch.relu(input)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 638.00 MiB. GPU 0 has a total capacty of 23.69 GiB of which 614.00 MiB is free. Process 1911303 has 167.52 MiB memory in use. Process 1911931 has 167.52 MiB memory in use. Process 1913507 has 167.52 MiB memory in use. Process 1914370 has 167.52 MiB memory in use. Process 1916021 has 167.52 MiB memory in use. Process 1916629 has 167.52 MiB memory in use. Process 1918460 has 167.52 MiB memory in use. Process 1919331 has 167.52 MiB memory in use. Process 1920936 has 167.52 MiB memory in use. Process 1921946 has 167.52 MiB memory in use. Process 1924554 has 9.03 GiB memory in use. Including non-PyTorch memory, this process has 5.42 GiB memory in use. Process 1925477 has 167.52 MiB memory in use. Process 1925590 has 167.52 MiB memory in use. Process 1928031 has 167.52 MiB memory in use. Process 1928034 has 167.52 MiB memory in use. Process 1930230 has 295.52 MiB memory in use. Process 1930109 has 295.52 MiB memory in use. Process 1932624 has 295.52 MiB memory in use. Process 1933055 has 295.52 MiB memory in use. Process 1935242 has 167.52 MiB memory in use. Process 1935632 has 167.52 MiB memory in use. Process 1937385 has 167.52 MiB memory in use. Process 1938101 has 167.52 MiB memory in use. Process 1939814 has 167.52 MiB memory in use. Process 1940602 has 167.52 MiB memory in use. Process 1942270 has 295.52 MiB memory in use. Process 1943047 has 295.52 MiB memory in use. Process 1945277 has 167.52 MiB memory in use. Process 1945551 has 167.52 MiB memory in use. Process 1947493 has 167.52 MiB memory in use. Process 1947907 has 167.52 MiB memory in use. Process 1950041 has 167.52 MiB memory in use. Process 1950465 has 167.52 MiB memory in use. Process 1952653 has 167.52 MiB memory in use. Process 1952963 has 255.52 MiB memory in use. Process 1955208 has 295.52 MiB memory in use. Process 1955525 has 167.52 MiB memory in use. Process 1957698 has 167.52 MiB memory in use. Process 1958027 has 167.52 MiB memory in use. Process 1960010 has 167.52 MiB memory in use. Process 1960302 has 167.52 MiB memory in use. Process 1962186 has 167.52 MiB memory in use. Process 1962850 has 167.52 MiB memory in use. Process 1964510 has 167.52 MiB memory in use. Process 1964892 has 167.52 MiB memory in use. Process 2005536 has 167.52 MiB memory in use. Of the allocated memory 2.51 GiB is allocated by PyTorch, and 2.58 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
[1;34mwandb[0m: 
[1;34mwandb[0m: ðŸš€ View run [33mfearless-sun-975[0m at: [34mhttps://wandb.ai/michael-bezick-purdue-university/pprl/runs/4bqu6m3s[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250908_141022-4bqu6m3s/logs[0m
